# Erie MCA Demo - Main Configuration
# Version: 2.0
# All parameters for synthetic data generation, models, and UI

project:
  name: "Erie Insurance Multi-Channel Attribution Demo"
  version: "2.0.0"
  random_seed: 42
  
# Erie Insurance Business Context
erie_context:
  headquarters: "Erie, Pennsylvania"
  founded: 1925
  operating_states: ["PA", "OH", "NY", "NC", "VA", "MD", "IN", "WI", "TN", "WV", "IL", "KY", "DC"]
  distribution_model: "100% independent agent"
  policies_in_force: "6M+"
  am_best_rating: "A+ (Superior)"
  agent_count_estimate: 12000
  estimated_annual_marketing_spend: 100000000  # $100M
  auto_new_business_binds_estimate: 200000  # Annual

# Synthetic Data Generation Parameters
synthetic_data:
  n_customers: 50000  # Total unique customer pool
  n_conversions: 2500  # Bound policies (5% overall conversion)
  date_range:
    start: "2025-01-01"
    end: "2025-12-31"
  
  # Erie-specific conversion funnel
  funnel_rates:
    awareness_to_consideration: 0.35
    consideration_to_quote: 0.22
    quote_to_bind: 0.18
    overall_conversion: 0.05
  
  # Journey characteristics
  journey:
    min_touchpoints: 2
    max_touchpoints: 12
    mean_touchpoints: 5.2
    median_days_to_conversion: 18
    max_journey_days: 90
  
  # Channel interaction probabilities (Erie-calibrated)
  channel_probabilities:
    first_touch_distribution:
      organic_search: 0.28
      paid_search_brand: 0.15
      paid_search_generic: 0.12
      display: 0.18
      social_organic: 0.08
      social_paid: 0.10
      email: 0.02
      direct: 0.05
      referral: 0.02
    
    subsequent_touch_distribution:
      organic_search: 0.22
      paid_search_brand: 0.18
      paid_search_generic: 0.10
      display: 0.08
      social_organic: 0.06
      social_paid: 0.07
      email: 0.05
      direct: 0.08
      referral: 0.03
      agent_call: 0.10
      agent_email: 0.03
    
    final_touch_distribution:  # Erie agents dominate conversions
      agent_call: 0.52
      agent_email: 0.15
      direct: 0.12
      paid_search_brand: 0.10
      organic_search: 0.06
      paid_search_generic: 0.03
      email: 0.02

# Channel Taxonomy (Erie-specific)
channels:
  definitions:
    - id: organic_search
      name: "Organic Search"
      type: digital
      cost_per_touch: 0.0
      macro_group: search
      
    - id: paid_search_brand
      name: "Paid Search - Brand"
      type: digital_paid
      cost_per_touch: 3.50
      macro_group: search
      
    - id: paid_search_generic
      name: "Paid Search - Generic"
      type: digital_paid
      cost_per_touch: 8.20
      macro_group: search
      
    - id: display
      name: "Display Advertising"
      type: digital_paid
      cost_per_touch: 2.10
      macro_group: display
      
    - id: social_organic
      name: "Social Media - Organic"
      type: digital
      cost_per_touch: 0.0
      macro_group: social
      
    - id: social_paid
      name: "Social Media - Paid"
      type: digital_paid
      cost_per_touch: 4.30
      macro_group: social
      
    - id: email
      name: "Email Marketing"
      type: digital
      cost_per_touch: 0.15
      macro_group: owned
      
    - id: direct
      name: "Direct (Type-in)"
      type: digital
      cost_per_touch: 0.0
      macro_group: owned
      
    - id: referral
      name: "Referral Sites"
      type: digital
      cost_per_touch: 1.50
      macro_group: owned
      
    - id: agent_call
      name: "Independent Agent - Call"
      type: agent
      cost_per_touch: 85.0  # Agent commission proxy
      macro_group: agent
      
    - id: agent_email
      name: "Independent Agent - Email"
      type: agent
      cost_per_touch: 45.0
      macro_group: agent
      
    - id: agent_office
      name: "Independent Agent - Office Visit"
      type: agent
      cost_per_touch: 120.0
      macro_group: agent
      
    - id: tv
      name: "TV Advertising"
      type: traditional
      cost_per_touch: 0.08
      macro_group: traditional

  macro_groups:
    - name: search
      channels: [organic_search, paid_search_brand, paid_search_generic]
    - name: display
      channels: [display]
    - name: social
      channels: [social_organic, social_paid]
    - name: owned
      channels: [email, direct, referral]
    - name: agent
      channels: [agent_call, agent_email, agent_office]
    - name: traditional
      channels: [tv]

# Attribution Models Configuration
attribution_models:
  # Tier 1: Heuristic Baselines
  last_click:
    enabled: true
    tier: 1
    
  first_click:
    enabled: true
    tier: 1
    
  linear:
    enabled: true
    tier: 1
    
  time_decay:
    enabled: true
    tier: 1
    half_life_days: 7
    
  position_based:
    enabled: true
    tier: 1
    first_touch_weight: 0.40
    last_touch_weight: 0.40
    middle_weight: 0.20
  
  # Tier 2: Shapley-Based
  shapley_simplified:
    enabled: true
    tier: 2
    use_macro_groups: true  # Reduce from 13 to 6 groups for speed
    monte_carlo_samples: 10000
    
  shapley_regression_mc:
    enabled: true
    tier: 2
    n_permutations: 5000
    regression_adjust: true
    
  casv:
    enabled: true
    tier: 2
    counterfactual_horizon: 7  # Days
  
  # Tier 3: Markov Chain Models
  markov_chain:
    enabled: true
    tier: 3
    order: 1  # 1st-order Markov
    removal_effect: true
    
  variable_order_markov:
    enabled: true
    tier: 3
    max_order: 2
    dirichlet_smoothing: 0.1
  
  # Tier 4: Statistical Models
  survival_attribution:
    enabled: true
    tier: 4
    distribution: "weibull"
    
  logistic_attribution:
    enabled: true
    tier: 4
    regularization: "l2"
    C: 1.0
  
  # Tier 5: Deep Learning Models
  lstm_attribution:
    enabled: true
    tier: 5
    hidden_size: 64
    num_layers: 2
    dropout: 0.3
    epochs: 50
    
  darnn:
    enabled: true
    tier: 5
    encoder_hidden: 64
    decoder_hidden: 64
    attention_window: 10
    epochs: 50
    
  transformer_attribution:
    enabled: true
    tier: 5
    d_model: 64
    nhead: 4
    num_layers: 3
    epochs: 50

# Budget Optimization Parameters
budget_optimization:
  baseline_budget: 5000000  # $5M monthly
  optimization_objective: "minimize_cpa"  # or "maximize_conversions"
  constraints:
    min_channel_budget_pct: 0.05  # 5% minimum per channel
    max_channel_budget_pct: 0.40  # 40% maximum per channel
    agent_budget_locked: false  # Agents are commissions, not budget
  
  scenarios:
    - name: "Current (Last-Click)"
      allocation_method: "last_click"
      
    - name: "Shapley-Optimized"
      allocation_method: "shapley"
      
    - name: "15% Shift to Upper Funnel"
      custom_shifts:
        paid_search_brand: -0.15
        display: +0.10
        social_paid: +0.05

# Validation & QA
validation:
  shapley_efficiency_tolerance: 0.0001
  cross_model_correlation_threshold: 0.70
  data_realism_checks:
    - journey_length_distribution
    - conversion_rate_by_channel
    - time_to_conversion_distribution
    - channel_transition_probabilities

# UI Configuration
ui:
  theme: "darkly"  # Dash Bootstrap Components theme
  brand_colors:
    primary: "#1f4788"  # Erie blue
    secondary: "#e31c3d"  # Accent red
    success: "#27ae60"
    warning: "#f39c12"
    danger: "#c0392b"
    
  pages:
    - path: "/"
      title: "Executive Summary"
      
    - path: "/model-comparison"
      title: "Model Comparison"
      
    - path: "/journey-explorer"
      title: "Journey Explorer"
      
    - path: "/budget-optimizer"
      title: "Budget Optimizer"
      
    - path: "/technical-appendix"
      title: "Technical Appendix"
  
  charts:
    default_height: 400
    animation_duration: 800
    plotly_template: "plotly_dark"

# Caching Strategy
caching:
  enabled: true
  cache_dir: "data/cache"
  ttl_seconds: 86400  # 24 hours
  precompute_on_startup: true

# Deployment
deployment:
  host: "0.0.0.0"
  port: 8050
  debug: false
  workers: 4
  timeout: 120
